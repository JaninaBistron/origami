<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="navigateHome()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title *ngIf="game">{{ game.name }}</ion-title>
    <ion-text slot="end" *ngIf="task">
      {{ taskIndex + 1 }} von {{ game.tasks.length }}
    </ion-text>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="wrapper" [class.blur]="showSuccess">
    <div #map class="map" [class.blur]="task != null && task.type == 'nav-arrow'"></div>
    <div *ngIf="swipe" #swipeMap class="map"></div>

    <ion-card class="overlay task-control ion-padding" [class.full]="task.type == 'nav-arrow'" *ngIf="task" [ngStyle]="{
        'flex-wrap': ['nav-arrow', 'theme-object'].includes(task.type)
          ? 'wrap'
          : 'nowrap'
      }">
      <div class="compass" *ngIf="task.type == 'nav-arrow'">
        <img src="/assets/icons/compass.png" [ngStyle]="{
            transform: 'rotate(' + targetHeading + 'deg)'
          }" />
        <p>Distanz: {{ Math.round(targetDistance) }} m</p>
      </div>
      <div class="photo-container" *ngIf="
          task.type == 'theme-object' &&
          task.settings['question-type'].name == 'photo'
        ">
        <img [src]="task.settings['question-type'].settings.photo" />
      </div>
      <div class="task-text">
        <p>
          {{ task.settings.text }}
        </p>
        <p *ngIf="task.settings.confirmation">
          Bestätige mit OK
        </p>
      </div>

      <ion-button class="confirm" (click)="onOkClicked()" *ngIf="task.settings.confirmation">OK
      </ion-button>
    </ion-card>
  </div>

  <ion-card class="overlay success" *ngIf="showSuccess">
    <h3>Herzlichen Glückwunsch</h3>
    <p>Du hast das Spiel beendet</p>
    <lottie-animation-view [options]="lottieConfig" [width]="300" [height]="300">
    </lottie-animation-view>
    <ion-button (click)="navigateHome()">Fertig</ion-button>
  </ion-card>

  <!-- <div class="overlay ion-padding" *ngIf="currentTask">
    <ion-img [src]="currentTask.question.img" *ngIf="currentTask.question.img"></ion-img>
    <h2>{{ currentTask.question.txt }}</h2>
    <ion-grid>
      <ion-row>
        <ion-col *ngFor="let answer of currentTask.answers">
          <ion-button (click)=nextTask()>
            {{ answer.txt }}
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div> -->
</ion-content>