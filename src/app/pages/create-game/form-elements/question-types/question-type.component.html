<!-- Task instruction - NavToFlag & NavWithArrow & NavViaText-->
<div
  *ngIf="question.type != questionTypeEnum.NAV_INSTRUCTION_PHOTO && (question[0]== undefined || question[0].type!= questionTypeEnum.NAV_INSTRUCTION_PHOTO)">

  <!-- temp: you may use ng-container -->

  <!-- Task instruction - Single-player mode -->
  <ng-container *ngIf="isSinlgeMode">
    <h5>
      {{ "CreateGame.taskInstruction" | translate }}
      <ion-icon name="information-circle" (click)="
          showPopover($event, 'Popover.taskInstruction')
        ">
      </ion-icon>
    </h5>
    <ion-textarea autoGrow [(ngModel)]='question.text'></ion-textarea>
  </ng-container>
  <!-- Task instruction - Multi-player mode -->
  <ng-container *ngIf="!isSinlgeMode">
    <ion-card style="color:black;">
      <ion-card-header style="color:black; font-size: medium; padding-top: 0.6rem;">
        <h5 style="margin-bottom: 10px;">
          {{ "CreateGame.taskInstruction" | translate }}
          <ion-icon name="information-circle" (click)="
            showPopover($event, 'Popover.taskInstruction')">
          </ion-icon>
        </h5>
      </ion-card-header>
      <ion-card-content style="padding-bottom: 0;">
        <div *ngFor="let e of [].constructor(numPlayers); let i = index" style="margin-bottom: 20px;">
          <h5> Player ({{i+1}})</h5>

          <ion-textarea autoGrow [(ngModel)]='question[i].text'></ion-textarea>
        </div>
      </ion-card-content>

      <!-- Markdown supported -->
      <ion-text color="medium">
        <p> &nbsp;
          {{ "CreateGame.markdownSupported" | translate }}
          <ion-icon name="information-circle" (click)="
          showPopover(
            $event,
            'Popover.markdown')">
          </ion-icon>
        </p>
      </ion-text>
    </ion-card>

  </ng-container>

</div>

<!-- Task instruction - NavViaPhoto -->
<div
  *ngIf="question.type == questionTypeEnum.NAV_INSTRUCTION_PHOTO || (question[0]!=undefined && question[0].type== questionTypeEnum.NAV_INSTRUCTION_PHOTO)">
  <!-- NavViaPhoto - Single-player mode -->
  <ng-container *ngIf="isSinlgeMode">
    <h5>
      {{ "CreateGame.photo" | translate }}
      <ion-icon name="information-circle" (click)="showPopover($event, 'Popover.photo')">
      </ion-icon>
    </h5>
    <app-photo-upload [(photo)]="question.photo" [taskType]="taskType" theme="primary"></app-photo-upload>
    <h5>
      {{ "CreateGame.navInstruction" | translate }}
      <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.navInstruction'
        )">
      </ion-icon>
    </h5>
    <ion-textarea autoGrow [(ngModel)]='question.text'></ion-textarea>
  </ng-container>
  <!-- NavViaPhoto - Multi-player mode -->
  <ng-container *ngIf="!isSinlgeMode">
    <div *ngFor="let e of [].constructor(numPlayers); let i = index">
      <h5>
        {{ "CreateGame.photo" | translate }} - player ({{i+1}})
        <ion-icon name="information-circle" (click)="showPopover($event, 'Popover.photo')" *ngIf="i==0">
        </ion-icon>
      </h5>
      <app-photo-upload [(photo)]="question[i].photo" [taskType]="taskType" theme="primary"></app-photo-upload>
      <h5>
        {{ "CreateGame.navInstruction" | translate }} - player ({{i+1}})
        <ion-icon name="information-circle" (click)="
          showPopover(
            $event,
            'Popover.navInstruction'
          )" *ngIf="i==0">
        </ion-icon>
      </h5>
      <ion-textarea autoGrow [(ngModel)]='question[i].text'></ion-textarea>
    </div>
  </ng-container>

  <!-- Markdown supported -->
  <ion-text color="medium">
    <p>
      {{ "CreateGame.markdownSupported" | translate }}
      <ion-icon name="information-circle" (click)="
          showPopover(
            $event,
            'Popover.markdown'
          )
        ">
      </ion-icon>
    </p>
  </ion-text>
</div>

<!-- Audio message -->
<!-- Audio message - Single-player mode -->
<ng-container *ngIf="isSinlgeMode">
  <div>
    <h5>
      {{ "CreateGame.audioMessage" | translate }}
      <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.audioMessage')">
      </ion-icon>
    </h5>
    <app-audio-recorder [(audioSource)]="question.audio"></app-audio-recorder>
  </div>
</ng-container>
<!-- Audio message - Multi-player mode -->
<ng-container *ngIf="!isSinlgeMode">
  <ion-card style="color:black;">
    <ion-card-header style="color:black; font-size: medium; padding-top: 0.6rem;">
      <h5>
        {{ "CreateGame.audioMessage" | translate }}
        <ion-icon name="information-circle" (click)="
            showPopover(
              $event,
              'Popover.audioMessage')">
        </ion-icon>
      </h5>

      <ion-item lines="none" class="ion-no-padding">
        <ion-label>
          All players has same audio:
        </ion-label>
        <ion-toggle [(ngModel)]="isAudioUnique" (ngModelChange)="setAudioCommonality($event)">
        </ion-toggle>
      </ion-item>
    </ion-card-header>
    <ion-card-content>
      <div *ngFor="let e of [].constructor( (isAudioUnique ? numPlayers-2 : numPlayers) ); let i = index" style="margin-bottom: 20px;">
        <h5> Player ({{i+1}})</h5>
        <app-audio-recorder [(audioSource)]="question[i].audio"></app-audio-recorder>
      </div>
    </ion-card-content>
  </ion-card>

</ng-container>




<div *ngIf="question.type == questionTypeEnum.MAP_FEATURE">
  <h5>
    {{ "CreateGame.objectLocation" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.objectLocation'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="geometry" drawTheme="searchArea" [(feature)]="question.geometry"
    [isVirtualWorld]="isVirtualWorld" [isVRMirrored]="isVRMirrored"></app-map>
</div>

<div *ngIf="question.type == questionTypeEnum.MAP_FEATURE_FREE">
  <h5>
    {{ "CreateGame.markedMap" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.markedMap'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="geometry-free" drawTheme="searchArea" [(feature)]="question.geometry"
    [isVirtualWorld]="isVirtualWorld" [isVRMirrored]="isVRMirrored"></app-map>
</div>

<div *ngIf="question.mode == taskModeEnum.NO_FEATURE">
  <h5>
    {{ "CreateGame.objectLocation" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.objectLocation'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="geometry" drawTheme="searchArea" [(feature)]="question.geometry"
    [isVirtualWorld]="isVirtualWorld" [isVRMirrored]="isVRMirrored"></app-map>
</div>

<div *ngIf="question.type == questionTypeEnum.MAP_FEATURE_PHOTO">
  <h5>
    {{ "CreateGame.objectPhoto" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.objectPhoto'
        )
      ">
    </ion-icon>
  </h5>
  <app-photo-upload [(photo)]="question.photo" [taskType]="taskType"></app-photo-upload>
  <h5>
    {{ "CreateGame.objectLocation" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.objectLocation'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="geometry" drawTheme="searchArea" [(feature)]="question.geometry"
    [isVirtualWorld]="isVirtualWorld" [isVRMirrored]="isVRMirrored"></app-map>
</div>

<div *ngIf="question.type == questionTypeEnum.MAP_DIRECTION">
  <h5>
    {{ "CreateGame.destinationDirection" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.destinationDirection'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="direction" [(feature)]="question.direction" [isVirtualWorld]="isVirtualWorld"
    [isVRMirrored]="isVRMirrored"></app-map>
</div>

<!-- Direction on the map -->
<div *ngIf="question.type == questionTypeEnum.MAP_DIRECTION_MARKER">
  <h5>
    {{ "CreateGame.directionMap" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.directionMap'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="direction" [(feature)]="question.direction" [isVirtualWorld]="isVirtualWorld"
    [isVRMirrored]="isVRMirrored"></app-map>
</div>

<div *ngIf="question.type == questionTypeEnum.MAP_DIRECTION_PHOTO">
  <h5>
    {{ "CreateGame.photoDirection" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.photoDirection'
        )
      ">
    </ion-icon>
  </h5>
  <app-photo-upload [(photo)]="question.photo" [taskType]="taskType"></app-photo-upload>
  <h5>
    {{ "CreateGame.directionMap" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.directionMap'
        )
      ">
    </ion-icon>
  </h5>
  <app-map featureType="direction" [(feature)]="question.direction"></app-map>
</div>

<div *ngIf="question.type == questionTypeEnum.PHOTO">
  <h5>
    {{ "CreateGame.photoTask" | translate }}
    <ion-icon name="information-circle" (click)="
        showPopover(
          $event,
          'Popover.photo'
        )
      ">
    </ion-icon>
  </h5>
  <app-photo-upload [(photo)]="question.photo" [taskType]="taskType"></app-photo-upload>
</div>